---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

This R Markdown document was created for Peer Assignment 1 for the COursera class Reproducible Research. 

## Loading and preprocessing the data

The folloowing code will read the data from the working directory and set the data type for each column

```{r}
activity <- read.csv("activity.csv", header=TRUE)
activity$steps <- as.numeric(activity$steps)
activity$date <- as.Date(activity$date)
activity$interval <- as.numeric(activity$interval)
```

Next, we will get the first few rows of the data

```{r}
head(activity)
```


## What is mean total number of steps taken per day?

To calculate the mean total number of steps taken per day we first must find the total steps taken per day. We must also make sure to remove "NA" values before we can calculate the sum. This code chuck will calculate the steps per day and output the head of the new dataset which includes the total steps per day.

```{r}
steps_per_day <- tapply(na.omit(activity)$steps, list(na.omit(activity)$date), sum)
head(steps_per_day)
```

Create a simple histogram of the total steps taken per day.

```{r}
hist(steps_per_day, breaks=25, col="red", main="Total Steps Per Day", xlab="The Total Steps Per Day", ylab="Frequency")
```

Find the mean and median of steps per day. Ignore missing values.   

```{r}
mean(steps_per_day, na.rm=TRUE)
median(steps_per_day, na.rm=TRUE)
```

## What is the average daily activity pattern?

The following code gets the average steps per interval and outputs the first few rows of the data.

```{r}
steps_per_interval <- tapply(na.omit(activity)$steps, list(na.omit(activity)$interval), mean)
head(steps_per_interval)
```

The following code will make a time series plot of the 5 minute interval and average number of steps taken averaged across all days.

```{r}
plot(names(steps_per_interval), steps_per_interval, type="l", main="Daily Activity Pattern", xlab="5 Minute Interval", ylab="Average Steps Per Interval", col="red", lwd=2)
```

The following code will determine which 5-minute interval contains the highest number of steps

```{r}
highest_steps <- which.max(steps_per_interval)
names(highest_steps)
```

## Imputing missing values

Now we will create a new dataset that will fill in missing datapoints with the average steps taken per interval where data is missing. First we will report the total number of missing values from the original dataset.

```{r}
sum(complete.cases(activity)==FALSE)
```



## Are there differences in activity patterns between weekdays and weekends?
